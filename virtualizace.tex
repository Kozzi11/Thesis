\section{Definice}
Virtualizace je proces, při kterém se vytváří (emuluje) virtuální prostředí místo skutečného. Jako příklad uveďme virtuální pamět. Ta se z pohledu systému tváří jako celistvý blok paměti s určitou velikostí. Avšak v reálu se virtuální paměť skládá z několika různě velkých, často odlišných typů paměti. (RAM, HDD \dots).

Virtualizovat se dá skoro vše. Ať už jsou to jednotlivé komponenty počítače (síťová karta, grafika, procesor \dots) nebo také kompletně celý počítač, což je nejčastější využití a pokud nebude uvedeno jinak, tak pojmem virtualizace bude míněna právě virtualizace celého počítače.
\section{Využití a výhody}
Virtualizace přináší mnoho výhod. Díky čemuž se poslední dobou značně rozšířila, nejen ve firmách, ale i ve školách a domácnostech.

Ve firmách nachází virtualizace hlavní uplatnění na serverech. Zde roli několika samostatných fyzických strojů převzal jeden nebo pár fyzických strojů, na nemž beží několik virtuálních strojů (serverů). Hojně se také využívá možnosti spouštět na jednom stroji více (i ruzných) operačních systémů. To se zejména hodí při testování produktu, který je navržen multiplatformě. Vývojáři pak mohou aplikaci testovat zároveň na všech cílových platformách bez potřeby dalšího počítače s daným operačním systémem. Dále se virtuaůizace využívá při psokytování hostingových služeb, kde se díky virtualizaci může klient pronajmout celý virtuální počítač a ten si nechat nakonfigurovat na míru svých požadavků. Což mu dává obrovskou míru flexibility. A nejen mu, ale i společnosti, jenž mu službu nabízí, jelikož virtualizace jí umožňuje snadné přidávání a odebírání systémových prostředků.

\subsection*{Hlavní výhody virtualizace}
\begin{enumerate}
  \item plné využití dostupných prostředků fyzického stroje
  \item snížení nákladů na pořizování HW (v určitých případech i SW)
  \item zvýšení bezpečnosti díky oddělenosti jednotlivých služeb (izolace)
  \item slepšení dostupnosti a stabilty (možnost migrace)
  \item snížení rizik a zjednodušení při vývoji a testování SW
  \item větší míra flexibility (přidělování systémových prostčedků)
  \item šetření zdrojů (nejen energetických)
\end{enumerate}
\section{Virtualizace počítače}
Způsobů jak řešit virtualizaci počítače je hned několik. V následující kapitole se podíváme na základní druhy virtualizace, které se dnes pužívají.

\subsection{Virtualizace x86 architektury}
V dnešní době je x86 nejrozšířenější architekturou počítačů. Proto možnost její virtualizace je určitě lákavým cílem. Na neštěstí se ukázalo, že virtualizace x86 architektury není zrovna tou nejsnažší věcí. Důvodem je několik málo instrukcí, které musí bežet v privilegovaném režimu procesoru a předpokládají přímí přístup k fyzické paměti. Tyto instrukce by mohli změnit stav libovolného virtuálního hosta, což je nežádoucí a činní je tak problematickými.

Obecným způsobem jak tentno problém řešit je nalezení volání těchto nebezpečných instrukcí a nahradit je jinými instrukcemi, které již nejsou takto nebezpečné. V praxi se používají dva přístupi. První přístup toto nahrazování řeší přímo za běhu. A to tak, že skenuje a analyzuje běžící kód a kdykoliv narazí na volání nebezpečné instrukce tak jej nahradí emulovanou verzí. Druhý přístup, ten se používá při paravirtualizaci, nahrazuje nebezpečné instrukce už v době kompilace. To má za následek větší rychlost ale za cenu nutnosti modifikovat jádro operačního systému hosta. Další řešení problému x86 architektury je přímá HW podpora virtualizace, kterou nabízejí novější procesory jak od Intel tak i od AMD. Každé z řešení má své výhody a nevýhody. většina virtualizačních řešení v dnešní době používá některé z prvních dvou řešení v kombinaci s HW podporou virtualizace pokud je dostupná.

\subsection{Plná virtualizace}
Plná virtualizace v anglické literatuře označovaná jako \emph{full virtualization}, je jedním ze základních druhů virtualizace počítače. Yákladním principem této virtualizace je emulace kompletně celého HW počítače se všemi jeho komponenty. Na takto vytvořený plně vyrtualizovaný počítač můžeme nainstalovat libovolný operační systém, který má podporu ovladačů pro emulovaný HW. Plná virtualizace umožňuje spustit libovolný počet virtuálních strojů s odlišným OS, kde každý poběží jako vlastní proces daného virtualizačního nástroje. Díky tomu, že se emuluje kompletně celý procesor i s jeho všemi úrovněmi ochrany, není třeba řešit problematické privilegované instrukce.
\subsubsection*{Výhody}
\begin{itemize}
  \item běží zde libovolný OS bez nutnosti modifikace jádra hosta (podmínkou jsou ovladače pro emulovaný HW)
  \item isolovanost jednotlivých virtualních strojů
  \item možnost spouštět virtuální stroje s různou architekturou (ARM, x86\_64, x86)
\end{itemize}
\subsubsection*{Nevýhody}
\begin{itemize}
  \item potřeba emulace všech komponent sebou nese větší režii
\end{itemize}
\subsection{Paravirtualizace}
Se nesnaží emulovat kompletně veškerý HW, naopak využívá toho, že virtualizovaný HW se příliš neliší od toho skutečného. Všude kde je to možné, paravirtualizovaný systém přistupuje přímo ke skutečnému HW počítače. Virtualizovaný systém často nemůže využívat plný potenciál reálného fyzického HW, a taky může rozpoznat, že běží na virtuálním počítači. Paravirtualizace narozdíl od plné virtualizace musí řešit problematické privilegované operace. Toto provádí již při kompilaci. Což přináší vyšší výkon za cenu nutnosti používat modifikované jádro operačního systému hosta.
\subsubsection*{Výhody}
\begin{itemize}
  \item u některých komponent je využíván přímí přístup (nejsou zcela emulovány) $\Rightarrow$ vyšší výkon
\end{itemize}
\subsubsection*{Nevýhody}
\begin{itemize}
  \item nutnost modifikovat jádro hosta
  \item nemožnost virtualizovat systémy, ke kterým nejsou dostupné zdrojové kódy, případně neexistuje jejich varianta již s modifikovaným jádrem
\end{itemize}

\subsection{Hardwarová podpora virtualizace}
Od roku 2007 většina procesorů od firem AMD i Intel obsahuje speciální instrukční sadu (HW podporu virtualizace). U AMD procesorů se tato technologie označuje jako AMD-V dříve známá pod pojmem Pacifik. Firma Intel používá pro svoje procesory s HW virtualizací označení Intel VT. Obě tyto technologie přináší podporu další úrovně ochrany v procesoru označovanou jako Ring $-$1. Díky této nové úrovni je možné, aby jádro virtualizovaného operačního systému běželo v procesoru v ochrané úrovni RING 0. A v ochrané úrovni RING $-$1 poběží VMM (Virtual Machine Manager/Monitor), někdy označován jako hypervizor. Díky čemuž není potřeba modifikované jádro hosta. tato nová úroveň ochrany není to jediné co hardwarová podpora virtualizace přináší. Přichází s ní mnohé další vylepšení umožňující usnadnění virtualizace dalších komponent než je procesor. Například velmi užitečným rozšířeným je přidání další vrstvy pro překlad adres. Tato vrstva umožňuje mapovat lineární pamět na hostovu fyzickou paměť. Podle průzkumu od VMware HW mapování oproti čistě softwarovému řešení, přináší nárust výkonu o 42\,\%.

\subsection{Virtualizace na úrovni systému}
Zde se nejedná o plnohodnotnou virtualizaci celého počítače, ale spíše jen o virtualizaci operačního systému. Virtualizace na úrovni systému je jedním z prvních způsobů jak rozdělit výkon jednoho fyzického stroje na více nezávislých částí. A to za účelem co největšího využití potenciálu daného počítače. Funguje to tak, že systém počítače je rozdělen na několi částí zvaných kontejnery. Každý kontejner obsahuje vlastní operační systém a určité přidělené systémové prostředky. Všechny kontejnery mezi sebou sdílí stejné jádro operačního systému. Z toho vyplívají hlavní nevýhody tohoto řešení. Krom jednotného jádra jsou jinak systémy zcela oddělené a nezávislé. Tato metoda virtualizace je velmi hojně využívána zejména v hostingových společnostech. Ačkoliv s příchodem HW podpory virtualizace a čím dál lepšímu výkonu plnohodnotných virtualizačních řešení, je používání systémové virtualizace na ústupu.

\subsubsection*{Výhody}
\begin{itemize}
  \item toto řešení má téměř nulovoou režii (okolo 2-3\,\%)
  \item není potřeba HW podpora virtualizace
\end{itemize}

\subsubsection*{Nevýhody}
\begin{itemize}
  \item všechny systémy sdílí jedno jádro, pokud spadne, spadnou všechny systémy
  \item možnost instalovat jen hosty se stejným operačním systémem
  \item mírně složitější konfigurace
\end{itemize}
